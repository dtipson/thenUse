!function(t){function n(){return n.fn.init.apply({},[Array.prototype.slice.call(arguments)])}n.fn=n.prototype={init:function(c,e){function i(c){return n.fn.init.call(c||t(this),void 0,s.stack)}function a(){var c=Array.prototype.slice.call(arguments),e=0,i=s.stack.slice(0);return t.each(i,function(t){if(i[t][2]&&i[t][2]>0){var n=c.slice(e,i[t][2]);i[t][1]=i[t][1].concat(n),i[t][2]=i[t][2]-n.length,e+=i[t][2]}}),console.log("new stack end",i),n.fn.init.apply(s.ctx,[void 0,i])}function r(){return!t.isEmptyObject(s.ctx)&&s.ctx[s.stack[0][0]]||t.isFunction(s.ctx)?s:t.extend(a,{on:i,the:i,$:function(){return i.apply(this)()},thenUse:s.thenUse,take:s.take,stack:s.stack,ctx:s.ctx})}var s=function(){var n=s.ctx,c=(s.stack.length,arguments);return t.isFunction(s.ctx)&&(n=s.ctx()),t.each(s.stack,function(t,e){n=n[e[0]].apply(n,e[1].concat(Array.prototype.slice.call(c,0,e[2]||0)))}),n};return t.extend(s,{stack:e||[[c[0],c.slice(1)]],ctx:this,thenUse:function(t){var c=Array.prototype.slice.call(arguments);return n.fn.init.call(s.ctx,void 0,s.stack.concat([[t,c.slice(1)||[]]]))},take:function(t){return this.stack.reverse()[0].push(t),r()}}),r()}},t.fn.use=function(t){return t&&t.stack&&t.stack[0]?n.fn.init.apply(this,[void 0,t.stack]):n.fn.init.apply(this,[Array.prototype.slice.call(arguments)])},window.use=n}(jQuery);